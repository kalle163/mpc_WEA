<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">u</span> = GetOptimaleStellgroese(<span class="var type1" id="S3T2U6">F</span>,<span class="var type1" id="S4T3U7">H</span>,<span class="var type1" id="S5T3U8">G</span>,<span class="var type1" id="S6T4U9">B</span>,<span class="var type1" id="S7T3U10">Qw</span>,<span class="var type1" id="S8T3U11">Rw</span>,<span class="var type1" id="S9T5U12">r</span>,<span class="var type1" id="S10T6U13">x</span>,<span class="var type1" id="S11T7U14">v</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">2</a></span><span class="line"><span class="mxinfo " id="T7:U11"><span class="var type1" id="S12T7U17">s1</span>=<span class="mxinfo " id="T7:U13">size(<span class="var type1" id="S6T4U20">B</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">3</a></span><span class="line"><span class="mxinfo " id="T7:U15"><span class="var type1" id="S14T7U24">s2</span>=<span class="mxinfo " id="T7:U17">size(<span class="var type1" id="S5T3U27">G</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">4</a></span><span class="line"><span class="mxinfo " id="T5:U19"><span class="var type1" id="S15T5U31">v_vec</span>=<span class="mxinfo " id="T5:U21"><span class="mxinfo " id="T5:U22">ones(<span class="var type1" id="S14T7U35">s2</span>,1)</span>*<span class="var type1" id="S11T7U37">v</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">5</a></span><span class="line"><span class="mxinfo " id="T5:U25"><span class="var type1" id="S17T5U40">u_work</span>= <span class="mxinfo " id="T5:U27"><span class="mxinfo " id="T3:U28"><span class="mxinfo " id="T3:U29"><span class="mxinfo " id="T3:U30">inv(<span class="mxinfo " id="T3:U31">(<span class="mxinfo " id="T3:U32"><span class="mxinfo " id="T3:U33"><span class="mxinfo " id="T3:U34"><span class="var type1" id="S4T3U51">H</span>'</span>*<span class="var type1" id="S8T3U52">Rw</span></span>*<span class="var type1" id="S4T3U53">H</span></span>)+<span class="var type1" id="S7T3U54">Qw</span></span>)</span>*<span class="mxinfo " id="T3:U39"><span class="var type1" id="S4T3U56">H</span>'</span></span>*<span class="var type1" id="S8T3U57">Rw</span></span>*(<span class="mxinfo " id="T5:U42"><span class="var type1" id="S9T5U60">r</span>-(<span class="mxinfo " id="T5:U44"><span class="mxinfo " id="T5:U45"><span class="var type1" id="S3T2U64">F</span>*<span class="var type1" id="S10T6U65">x</span></span>+<span class="mxinfo " id="T5:U48"><span class="var type1" id="S5T3U67">G</span>*<span class="var type1" id="S15T5U68">v_vec</span></span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">6</a></span><span class="line"><span class="mxinfo " id="T1:U51"><span class="var type1" id="S2T1U71">u</span>=<span class="mxinfo " id="T1:U53"><span class="var type1" id="S17T5U73">u_work</span>(<span class="mxinfo " id="T8:U55"><span class="mxinfo " id="T7:U56">1</span>:<span class="var type1" id="S12T7U76">s1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">7</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
